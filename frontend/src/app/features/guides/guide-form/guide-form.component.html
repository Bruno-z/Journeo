<div class="editor-layout">
  
  <!-- â•â•â•â•â•â•â•â• GAUCHE : FORMULAIRE â•â•â•â•â•â•â•â• -->
  <div class="editor-main">
    <div class="editor-header">
      <h1 class="editor-title">{{ isEdit() ? 'Modifier le guide' : 'CrÃ©er un guide' }}</h1>
      <p class="editor-subtitle">Partagez votre expÃ©rience et inspirez la communautÃ© Journeo.</p>
    </div>

    <form [formGroup]="form" (ngSubmit)="submit()">
      
      <!-- Titre -->
      <div class="form-group">
        <label class="form-label">Titre du voyage</label>
        <input 
          type="text" 
          class="input-huge" 
          formControlName="titre"
          placeholder="Ex: Week-end Ã  Rome..." 
          autofocus
        >
      </div>

      <!-- Description -->
      <div class="form-group">
        <label class="form-label">L'expÃ©rience en quelques mots</label>
        <textarea 
          class="input-area" 
          rows="3" 
          formControlName="description"
          placeholder="Qu'est-ce qui rend ce voyage unique ? DÃ©crivez l'ambiance..."
        ></textarea>
      </div>

      <!-- Saison (Tuiles) -->
      <div class="form-group">
        <label class="form-label">Saison idÃ©ale</label>
        <div class="tiles-grid">
          @for (key of saisons; track key) {
            <div 
              class="tile" 
              [class.selected]="form.value.saison === key" 
              (click)="setVal('saison', key)"
            >
              <div class="tile__icon">
                @if(key === 'ETE'){ â˜€ï¸ } @else if(key === 'HIVER'){ â„ï¸ } @else if(key === 'PRINTEMPS'){ ğŸŒ¸ } @else { ğŸ‚ }
              </div>
              <div class="tile__label">{{ saisonLabels[key] }}</div>
            </div>
          }
        </div>
      </div>

      <!-- Grid 2 colonnes pour MobilitÃ© & Cible -->
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
        
        <div class="form-group">
          <label class="form-label">MobilitÃ©</label>
          <div class="tiles-grid" style="grid-template-columns: 1fr 1fr;">
            @for (key of mobilites; track key) {
              <div class="tile" [class.selected]="form.value.mobilite === key" (click)="setVal('mobilite', key)">
                <div class="tile__icon">
                  @if(key === 'A_PIED'){ ğŸš¶ } @else if(key === 'VELO'){ ğŸš² } @else if(key === 'VOITURE'){ ğŸš— } @else { ğŸšŒ }
                </div>
                <div class="tile__label">{{ mobiliteLabels[key] }}</div>
              </div>
            }
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Pour qui ?</label>
          <div class="tiles-grid" style="grid-template-columns: 1fr 1fr;">
            @for (key of cibles; track key) {
              <div class="tile" [class.selected]="form.value.pourQui === key" (click)="setVal('pourQui', key)">
                <div class="tile__icon">
                  @if(key === 'FAMILLE'){ ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ } @else if(key === 'COUPLE'){ ğŸ’‘ } @else if(key === 'ENTRE_AMIS'){ ğŸ‘¯ } @else { ğŸ’ }
                </div>
                <div class="tile__label">{{ publicCibleLabels[key] }}</div>
              </div>
            }
          </div>
        </div>
      </div>

      <!-- DurÃ©e -->
      <div class="form-group">
        <label class="form-label">DurÃ©e (jours)</label>
        <div style="display: flex; align-items: center; gap: 1rem;">
          <input type="range" formControlName="jours" min="1" max="15" style="flex: 1; accent-color: #E85A1E;">
          <span style="font-size: 1.5rem; font-weight: 800; color: #E85A1E; min-width: 3ch;">{{ form.value.jours }}j</span>
        </div>
      </div>

      <!-- Actions -->
      <div class="actions-bar">
        <button type="submit" class="btn btn--primary btn-lg" [disabled]="form.invalid || saving() || loading()">
          @if(saving()){ <span class="spinner"></span> } 
          {{ isEdit() ? 'Enregistrer' : 'CrÃ©er le guide' }}
        </button>
        <button type="button" (click)="cancel()" class="btn btn--ghost btn-lg">Annuler</button>
      </div>

    </form>
  </div>

  <!-- â•â•â•â•â•â•â•â• DROITE : PREVIEW â•â•â•â•â•â•â•â• -->
  <div class="editor-sidebar">
    <div class="preview-badge">AperÃ§u en direct</div>
    
    <!-- La Carte -->
    <div class="guide-card">
      <div class="guide-card__img-wrap">
        <img [src]="coverPreview()" class="guide-card__img" alt="Cover">
        <div class="guide-card__overlay"></div>
        @if (form.value.saison) {
          <span class="guide-card__season">{{ saisonLabels[form.value.saison!] }}</span>
        }
      </div>
      <div class="guide-card__body">
        <h3 class="guide-card__title">{{ form.value.titre || 'Titre du guide...' }}</h3>
        <div class="guide-card__chips">
          @if (form.value.mobilite) {
            <span class="chip chip--blue">{{ mobiliteLabels[form.value.mobilite!] }}</span>
          }
          @if (form.value.pourQui) {
            <span class="chip chip--green">{{ publicCibleLabels[form.value.pourQui!] }}</span>
          }
          @if (form.value.jours) {
            <span class="chip chip--orange">{{ form.value.jours }}j</span>
          }
        </div>
      </div>
    </div>

    <div style="margin-top: 2rem; text-align: center; color: #9ca3af; font-size: 0.9rem;">
      <p>Cette carte sera visible par les autres utilisateurs sur la page d'accueil.</p>
    </div>
  </div>

</div>
